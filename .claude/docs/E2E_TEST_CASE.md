# E2E 테스트 케이스 명세서

## 목차

1. [개요](#개요)
2. [테스트 환경 설정](#테스트-환경-설정)
3. [1. 기본 일정 관리 워크플로우 (CRUD)](#1-기본-일정-관리-워크플로우-crud)
4. [2. 반복 일정 관리 워크플로우](#2-반복-일정-관리-워크플로우)
5. [3. 일정 겹침 처리](#3-일정-겹침-처리)
6. [4. 알림 시스템](#4-알림-시스템)
7. [5. 검색 및 필터링](#5-검색-및-필터링)

---

## 개요

### 목적

캘린더 애플리케이션의 핵심 기능들이 실제 사용자 환경에서 정상적으로 동작하는지 검증합니다.

### 테스트 프레임워크

- **E2E 도구**: Playwright
- **브라우저**: Chromium, Firefox, WebKit
- **테스트 위치**: `/e2e` 디렉토리

### 우선순위

1. 기본 일정 관리 워크플로우 (CRUD)
2. 반복 일정 관리 워크플로우
3. 일정 겹침 처리
4. 알림 시스템
5. 검색 및 필터링

---

## 테스트 환경 설정

### 사전 준비

```typescript
// 테스트용 데이터베이스 파일 준비
// e2e/fixtures/test-events.json
{
  "events": [
    {
      "id": "1",
      "title": "기존 회의",
      "date": "2025-11-15",
      "startTime": "09:00",
      "endTime": "10:00",
      "description": "정기 팀 미팅",
      "location": "회의실 A",
      "category": "업무",
      "repeat": { "type": "none", "interval": 0 },
      "notificationTime": 10
    }
  ]
}
```

### 테스트 설정

```typescript
// playwright.config.ts 업데이트 필요
export default defineConfig({
  testDir: './e2e',
  use: {
    baseURL: 'http://localhost:5173',
  },
  webServer: {
    command: 'pnpm run dev',
    url: 'http://localhost:5173',
    reuseExistingServer: !process.env.CI,
  },
});
```

---

## 1. 기본 일정 관리 워크플로우 (CRUD)

### 테스트 파일: `e2e/basic-event-workflow.spec.ts`

### 1.1 페이지 로드 시 저장된 일정 표시

- [ ] 페이지를 로드했을 때 월간 캘린더 뷰가 표시되는지 확인
- [ ] 저장되어 있던 일정이 해당 날짜 셀에 표시되는지 확인
- [ ] 저장되어 있던 일정이 우측 이벤트 리스트에 표시되는지 확인
- [ ] "일정 로딩 완료!" 토스트 메시지가 표시되는지 확인

### 1.2 일정 생성 및 저장

- [ ] 제목 "팀 회의", 날짜 선택, 시작 시간 "09:00", 종료 시간 "10:00" 입력
- [ ] 설명 "주간 팀 미팅", 위치 "회의실 A", 카테고리 "업무" 입력
- [ ] "일정 추가" 버튼 클릭
- [ ] 해당 날짜 셀에 일정이 등록되는지 확인
- [ ] 이벤트 리스트에 새로운 일정이 추가되는지 확인
- [ ] "일정이 추가되었습니다" 토스트 메시지가 표시되는지 확인

### 1.3 일정 수정

- [ ] 이벤트 리스트에 있던 일정의 편집 버튼 클릭
- [ ] 일정 폼에 기존 데이터가 채워져 있는지 확인
- [ ] 제목을 "전체 회의"로, 시간을 "10:00-11:00"으로 수정
- [ ] "일정 수정" 버튼 클릭
- [ ] 날짜 셀과 이벤트 리스트에 수정 내용이 반영되는지 확인
- [ ] "일정이 수정되었습니다" 토스트 메시지가 표시되는지 확인

### 1.4 일정 삭제

- [ ] 이벤트 리스트에 있던 일정의 삭제 버튼 클릭
- [ ] 해당 날짜 셀에서 일정이 제거되는지 확인
- [ ] 이벤트 리스트에서 일정이 제거되는지 확인
- [ ] "일정이 삭제되었습니다" 토스트 메시지가 표시되는지 확인

---

## 2. 반복 일정 관리 워크플로우

### 테스트 파일: `e2e/recurring-event-workflow.spec.ts`

### 2.1 반복 일정 추가하기

- [ ] 제목 "주간 회의", 날짜 선택 (월요일), 시간 "14:00-15:00" 입력
- [ ] "반복 일정" 체크박스 선택, 반복 유형 "매주", 반복 간격 "1", 종료일 (4주 후) 설정
- [ ] "일정 추가" 버튼 클릭
- [ ] 월간 캘린더에 반복 일정들(4개)이 표시되는지 확인
- [ ] 이벤트 리스트에 모든 반복 일정이 표시되는지 확인
- [ ] 각 일정에 반복 아이콘이 표시되는지 확인

### 2.2 반복 일정 수정 → 단일로 수정

- [ ] 반복 일정 중 하나의 편집 버튼 클릭
- [ ] "반복 일정 수정" 다이얼로그가 표시되는지 확인
- [ ] "예(해당 일정만 수정)" 버튼 클릭
- [ ] 제목을 "긴급 회의"로 변경 후 "일정 수정" 클릭
- [ ] 해당 일정만 제목이 변경되고 다른 반복 일정은 유지되는지 확인
- [ ] 수정된 일정의 반복 아이콘이 사라졌는지 확인 (단일 일정으로 변환)

### 2.3 반복 일정 수정 → 모두 수정

- [ ] 반복 일정 중 하나의 편집 버튼 클릭
- [ ] "반복 일정 수정" 다이얼로그에서 "아니오(모든 일정 수정)" 버튼 클릭
- [ ] 시간을 "15:00-16:00"으로 변경 후 "일정 수정" 클릭
- [ ] 같은 시리즈의 모든 반복 일정의 시간이 변경되는지 확인
- [ ] 모든 일정에 여전히 반복 아이콘이 표시되는지 확인

### 2.4 반복 일정 삭제 → 단일로 삭제

- [ ] 반복 일정 중 하나의 삭제 버튼 클릭
- [ ] "반복 일정 삭제" 다이얼로그가 표시되는지 확인
- [ ] "예(해당 일정만 삭제)" 버튼 클릭
- [ ] 해당 일정만 날짜 셀과 이벤트 리스트에서 제거되는지 확인
- [ ] 다른 반복 일정은 유지되는지 확인

### 2.5 반복 일정 삭제 → 모두 삭제

- [ ] 반복 일정 중 하나의 삭제 버튼 클릭
- [ ] "반복 일정 삭제" 다이얼로그에서 "아니오(모든 일정 삭제)" 버튼 클릭
- [ ] 같은 시리즈의 모든 반복 일정이 날짜 셀과 이벤트 리스트에서 제거되는지 확인

---

## 3. 일정 겹침 처리

### 테스트 파일: `e2e/event-overlap.spec.ts`

### 3.1 같은 시간대 일정 추가 시 겹침 모달 → 계속 진행 선택

- [ ] "기존 회의" 일정이 "2025-11-15 09:00-10:00"에 존재하는지 확인
- [ ] 새 일정 제목 "신규 회의", 같은 날짜 "2025-11-15", 시간 "09:30-10:30" 입력 (시간 겹침)
- [ ] "일정 추가" 버튼 클릭
- [ ] "일정 겹침 경고" 다이얼로그가 표시되는지 확인
- [ ] "다음 일정과 겹칩니다:" 메시지와 겹치는 일정 정보 표시 확인
- [ ] "계속 진행" 버튼 클릭
- [ ] 겹치는 두 일정이 모두 날짜 셀에 표시되는지 확인
- [ ] 겹치는 두 일정이 모두 이벤트 리스트에 표시되는지 확인
- [ ] "일정이 추가되었습니다" 토스트 메시지가 표시되는지 확인

### 3.2 같은 시간대 일정 추가 시 겹침 모달 → 취소 선택

- [ ] "점심 회의" 일정이 "2025-11-16 12:00-13:00"에 존재하는지 확인
- [ ] 새 일정 제목 "점심 식사", 같은 날짜 "2025-11-16", 시간 "12:30-13:30" 입력 (시간 겹침)
- [ ] "일정 추가" 버튼 클릭
- [ ] "일정 겹침 경고" 다이얼로그가 표시되는지 확인
- [ ] "취소" 버튼 클릭
- [ ] 다이얼로그가 닫히는지 확인
- [ ] 새 일정이 생성되지 않았는지 확인 (날짜 셀과 이벤트 리스트)
- [ ] 일정 폼의 데이터는 그대로 유지되는지 확인 (사용자가 시간을 수정할 수 있도록)

---

## 4. 알림 시스템

### 테스트 파일: `e2e/notification-system.spec.ts`

### 4.1 알림 설정한 시간에 일정 알림 표시

- [ ] 현재 시간으로부터 10분 후 시작되는 일정 생성
  - 제목: "곧 시작할 회의"
  - 날짜: 오늘
  - 시작 시간: 현재 시간 + 10분
  - 알림 설정: 10분 전
- [ ] "일정 추가" 버튼 클릭
- [ ] 화면 우측 상단(position: fixed)에 알림 컴포넌트가 즉시 표시되는지 확인
- [ ] 알림 메시지 "10분 후 곧 시작할 회의 일정이 시작됩니다." 표시 확인
- [ ] 알림의 닫기 버튼(X) 클릭하여 알림이 사라지는지 확인

### 4.2 같은 일정에 대한 중복 알림 방지

- [ ] 위에서 생성한 일정이 아직 10분 이내에 시작되는 상태 유지
- [ ] 페이지 새로고침 또는 1-2초 대기
- [ ] 같은 일정에 대한 알림이 다시 표시되지 않는지 확인
- [ ] 다른 일정을 10분 이내 시작으로 추가 생성
  - 제목: "다른 회의"
  - 시작 시간: 현재 시간 + 10분
  - 알림 설정: 10분 전
- [ ] 새로운 일정에 대한 알림만 추가로 표시되는지 확인
- [ ] 이전 일정("곧 시작할 회의")에 대한 중복 알림은 표시되지 않는지 확인

---

## 5. 검색 및 필터링

### 테스트 파일: `e2e/search-and-filter.spec.ts`

### 5.1 일정 검색 시 일치하는 일정만 표시

- [ ] 다양한 제목의 일정 생성
  - "팀 회의" (2025-11-15)
  - "개인 공부" (2025-11-16)
  - "점심 약속" (2025-11-17)
  - "프로젝트 회의" (2025-11-18)
- [ ] 이벤트 리스트 상단의 검색 입력창에 "회의" 입력
- [ ] 이벤트 리스트에 "팀 회의"와 "프로젝트 회의"만 표시되는지 확인
- [ ] "개인 공부"와 "점심 약속"은 표시되지 않는지 확인
- [ ] 캘린더에는 모든 일정이 여전히 표시되는지 확인

### 5.2 특정 기간에 대한 필터링 (월간 뷰)

- [ ] 여러 달에 걸쳐 일정 생성
  - "11월 회의" (2025-11-20)
  - "12월 회의" (2025-12-15)
  - "1월 회의" (2026-01-10)
- [ ] 월간 뷰(기본값)에서 현재 월(11월)의 일정만 이벤트 리스트에 표시되는지 확인
- [ ] 다음 달 버튼 클릭하여 12월로 이동
- [ ] 이벤트 리스트에 12월 일정만 표시되는지 확인
- [ ] 캘린더와 이벤트 리스트가 동기화되어 있는지 확인

### 5.3 특정 기간에 대한 필터링 (주간 뷰)

- [ ] 주간 뷰 선택 버튼 클릭
- [ ] 캘린더가 주간 뷰로 전환되는지 확인
- [ ] 현재 주(월~일)의 일정만 이벤트 리스트에 표시되는지 확인
- [ ] 다음 주 버튼 클릭
- [ ] 이벤트 리스트에 다음 주의 일정만 표시되는지 확인

### 5.4 검색 초기화 시 모든 일정 표시

- [ ] 검색창에 "회의" 입력하여 필터링된 상태
- [ ] 검색창의 내용을 전체 삭제 (빈 문자열)
- [ ] 이벤트 리스트에 현재 뷰(월간/주간)의 모든 일정이 다시 표시되는지 확인
- [ ] 캘린더에도 모든 일정이 표시되는지 확인

### 5.5 검색과 기간 필터 조합

- [ ] 월간 뷰에서 검색창에 "회의" 입력
- [ ] 현재 월의 "회의" 관련 일정만 이벤트 리스트에 표시되는지 확인
- [ ] 다음 달 버튼 클릭
- [ ] 검색어가 유지되고 다음 달의 "회의" 관련 일정만 표시되는지 확인
- [ ] 주간 뷰로 전환
- [ ] 검색어가 유지되고 현재 주의 "회의" 관련 일정만 표시되는지 확인

---

## 테스트 실행 가이드

### 개발 환경에서 실행

```bash
# 1. 개발 서버 시작
pnpm run dev

# 2. 별도 터미널에서 E2E 테스트 실행
npx playwright test

# 3. UI 모드로 실행 (디버깅)
npx playwright test --ui

# 4. 특정 파일만 실행
npx playwright test e2e/basic-event-workflow.spec.ts

# 5. 특정 브라우저에서만 실행
npx playwright test --project=chromium
```

### CI 환경에서 실행

```bash
# 모든 브라우저에서 테스트 실행
npx playwright test --project=chromium --project=firefox --project=webkit
```

### 테스트 리포트 확인

```bash
# HTML 리포트 생성 및 열기
npx playwright show-report
```

---

## 주의사항

### 테스트 데이터 관리

- 각 테스트는 독립적으로 실행되어야 합니다
- `beforeEach`에서 테스트 DB를 초기 상태로 리셋
- 테스트 간 데이터 의존성 제거

### 타이밍 이슈

- Playwright의 자동 대기 기능 활용 (`await expect(...).toBeVisible()`)
- 필요 시 명시적 대기 추가 (`page.waitForTimeout()`)
- 알림 테스트는 실제 시간 흐름을 시뮬레이션해야 함

### 접근성

- 가능한 한 `getByRole`, `getByLabel`, `getByText` 사용
- ID나 클래스명보다 사용자 관점의 셀렉터 우선

### 테스트 격리

- 각 테스트 파일은 독립적으로 실행 가능해야 함
- 전역 상태나 공유 데이터에 의존하지 않음

---

## 체크리스트 요약

### 핵심 E2E 테스트 케이스 (총 18개 시나리오)

#### 1. 기본 일정 관리 워크플로우 (4개)

- 페이지 로드 시 저장된 일정 표시
- 일정 생성 및 저장
- 일정 수정
- 일정 삭제

#### 2. 반복 일정 관리 (5개)

- 반복 일정 추가하기
- 반복 일정 수정 → 단일로 수정
- 반복 일정 수정 → 모두 수정
- 반복 일정 삭제 → 단일로 삭제
- 반복 일정 삭제 → 모두 삭제

#### 3. 일정 겹침 처리 (2개)

- 같은 시간대 일정 추가 시 겹침 모달 → 계속 진행 선택
- 같은 시간대 일정 추가 시 겹침 모달 → 취소 선택

#### 4. 알림 시스템 (2개)

- 알림 설정한 시간에 일정 알림 표시
- 같은 일정에 대한 중복 알림 방지

#### 5. 검색 및 필터링 (5개)

- 일정 검색 시 일치하는 일정만 표시
- 특정 기간에 대한 필터링 (월간 뷰)
- 특정 기간에 대한 필터링 (주간 뷰)
- 검색 초기화 시 모든 일정 표시
- 검색과 기간 필터 조합

---

### E2E vs 단위/통합 테스트 분리

**E2E 테스트 (22개)**: 핵심 사용자 워크플로우만 검증

- 전체 애플리케이션 동작
- 브라우저 환경에서의 실제 사용자 시나리오
- 주요 기능의 완전한 플로우

**단위/통합 테스트**: 세부 케이스 및 엣지 케이스 검증

- 필드 유효성 검사
- 에러 메시지 표시
- 다양한 입력 조합
- 경계값 테스트
- 성능 테스트
